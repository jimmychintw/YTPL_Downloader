# **YTPL_Downloader 開發指南 v1.1**

## **專案概述**

YTPL\_Downloader 是一個自動化的 YouTube Playlist 下載工具，監控指定的 Playlist，自動下載新影片並從雲端移除。專案強調模組化設計、錯誤處理和無資料庫的檔案系統管理。

## **開發理念：控制節奏，確保品質**

### **核心原則**

1. **停一停，驗一驗**：每個小功能完成後必須驗證，不要一口氣寫完整個模組。  
2. **真實資料優先**：盡可能使用真實資料測試，避免過度依賴假資料。  
3. **漸進式開發**：小步快跑，頻繁驗證。  
4. **透明溝通**：任何設計決策都要說明理由。

### **階段控制 STOP 🛑 規則**

\- 完成每個函數後，STOP，等待驗證。  
\- 使用外部 API 前，STOP，討論測試資料。  
\- 整合多個組件前，STOP，確認介面。  
\- 寫超過 30 行程式碼，STOP，先測試。

***註記***：「寫超過 30 行程式碼，STOP」 是一個強力的指導原則，用來防止函式過於臃腫複雜。我們會將其視為一個「強力提醒」而非「絕對禁令」。若某個函式的邏輯單元清晰，但為了可讀性需要較多行數表達，我們可以超過此限制。但在這種情況下，我會主動向您說明理由，以符合「透明溝通」的原則。

## **模組開發順序與策略**

### **階段 0：專案初始化與環境設定 (新增)**

在撰寫任何功能性程式碼之前，我們先完成專案的基礎設定，確保開發環境的一致性。

* \[ \] **環境確認**：確認 Python 版本 (3.13+)。  
* \[ \] **虛擬環境**：建立 venv 虛擬環境。  
* \[ \] **版本控制**：初始化 git 倉庫，並建立初始 commit。  
* \[ \] **目錄結構**：根據 SDD v1.1 的規劃，創建專案的基礎目錄結構 (例如 src/ 等資料夾)。  
* \[ \] **依賴文件**：建立空的 requirements.txt。

### **建議開發順序**

開發將從最基礎、最獨立的模組開始，逐步向上整合。  
0\. 專案初始化 → 1\. logger.py → 2\. config\_parser.py → 3\. file\_manager.py → 4\. youtube\_api\_client.py → 5\. video\_downloader.py → 6\. main\_downloader.py  
但如果你發現更好的順序或方法，請大膽提出並說明理由。

### **模組開發流程**

每個模組開發分為以下階段：

1. **設計討論** → 2\. **基礎框架** → 3\. **單元功能** → 4\. **整合測試** → 5\. **真實資料驗證**

## **實際資料協作模式**

### **測試資料需求清單**

在開發過程中，我會配合提供以下真實資料：

1. **config.ini 測試資料**  
   * 實際的配置檔範例  
   * 錯誤配置案例  
   * 邊界條件測試案例  
2. **YouTube API 測試資料**  
   * 測試用 Playlist ID（我會提供 1-2 個）  
   * API 回應範例（可手動獲取）  
   * OAuth 測試策略（需討論安全方式）  
3. **檔案系統測試資料**  
   * 特殊字符檔名測試  
   * 已存在的目錄結構  
   * video\_info.json 範例

### **建議的對話模式**

你: "我準備實作 \[功能X\]，需要以下測試資料：..."  
我: "這是實際資料：..." 或 "讓我們先討論測試策略"  
你: "使用你的資料，測試結果是..."

## **各模組開發檢查點**

(此處省略各模組檢查點細節，與原文件相同)

...

## **品質把關原則**

### **程式碼品質標準**

* PEP 8 規範  
* 完整的 docstring  
* 有意義的變數命名  
* 適當的錯誤處理  
* 避免硬編碼

### **測試要求**

* 每個函數都要有基本測試  
* 邊界條件必須覆蓋  
* 錯誤情況必須處理

## **技術約束與環境**

* Python 3.13+  
* macOS 環境  
* 使用 yt-dlp 作為下載核心  
* OAuth 2.0 Desktop Flow（非 Web）  
* 無資料庫依賴

## **特別指令**

1. 每次都用審視的目光，仔細看我輸入的潛在問題，你要指出我的問題，並給出明顯在我思考框架之外的建議。如果你覺得我說的太離譜了，你就罵回來，幫我瞬間清醒。
2. 全部用繁體中文溝通

### **協作期待**

1. **主動提問**：不確定就問，特別是涉及外部資源時。  
2. **批判思考**：如果 PRD/SDD 有問題，直接指出。  
3. **超前思考**：預見潛在問題並提前解決。  
4. **教學相長**：解釋你的設計決策，讓我學習。

## **開放式問題與思考**

* 是否需要實作並發下載？（效能 vs 複雜度）  
* 如何處理超大檔案？（\> 10GB 的影片）  
* 是否需要下載進度的 GUI 顯示？  
* 如何優雅處理網路中斷？  
* 是否需要支援代理設定？  
* 如何處理私人影片或地區限制？